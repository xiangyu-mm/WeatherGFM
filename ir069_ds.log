srun: job 3968558 queued and waiting for resources
srun: job 3968558 has been allocated resources
srun: Job 3968558 scheduled successfully!
Current QUOTA_TYPE is [reserved], which means the job has occupied quota in RESERVED_TOTAL under your partition.
Current PHX_PRIORITY is normal

using dsdsds
using dsdsds
using dsdsds
using dsdsds
job dir: /mnt/petrelfs/zhaoxiangyu1/code/weather_prompt_new
Namespace(save_ckpt_freq=1,
batch_size=20,
epochs=30,
accum_iter=4,
model='mae_vit_large_patch16_dec512d8b_input256',
input_size=256,
mask_ratio=0.75,
ckpt='/mnt/petrelfs/zhaoxiangyu1/code/weather_prompt_new/experiments/weather_5tasks/checkpoint-49.pth',
weight_decay=0.05,
lr=None,
blr=0.0001,
min_lr=1e-05,
warmup_epochs=1,
break_after_epoch=None,
data_path='/mnt/petrelfs/zhaoxiangyu1/data/Test100_256',
data_path_val='/mnt/petrelfs/zhaoxiangyu1/data/Test100_256',
imagenet_percent=1,
subsample=False,
output_dir='experiments/large_model/ir069ds',
log_dir='./output_dir',
device='cuda',
seed=0,
resume='',
start_epoch=0,
num_workers=1,
pin_mem=True,
world_size=1,
local_rank=-1,
dist_on_itp=False,
dist_url='env://')
2400
Head: Simple_Head
Load pretrained model:  /mnt/petrelfs/zhaoxiangyu1/code/weather_prompt_new/experiments/weather_5tasks/checkpoint-49.pth
<All keys matched successfully>
Model = MaskedAutoencoderViT(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(2, 1024, kernel_size=(16, 16), stride=(16, 16))
    (norm): Identity()
  )
  (patch_embed_4c): PatchEmbed(
    (proj): Conv2d(4, 1024, kernel_size=(16, 16), stride=(16, 16))
    (norm): Identity()
  )
  (align_patch): Linear(in_features=1024, out_features=1024, bias=True)
  (blocks): ModuleList(
    (0-23): 24 x Block(
      (norm1): LayerNorm((1024,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=1024, out_features=3072, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=1024, out_features=1024, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((1024,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((1024,), eps=1e-06, elementwise_affine=True)
  (decoder_embed): Linear(in_features=1024, out_features=512, bias=True)
  (decoder_blocks): ModuleList(
    (0-7): 8 x Block(
      (norm1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (decoder_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  (decoder_pred): Linear(in_features=512, out_features=512, bias=True)
  (decoder_pred_4c): Linear(in_features=512, out_features=1024, bias=True)
  (CNN_Head): Simple_Head(
    (conv_first): Conv2d(2, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (HRconv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (conv_last): Conv2d(64, 2, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (lrelu): LeakyReLU(negative_slope=0.1, inplace=True)
  )
  (L1_loss): L1Loss()
)
